<!DOCTYPE html>
<html lang="en">
<head>
    @@include('layout/meta.html', {
        "title" : "最新消息管理"
    })
</head>
<!-- 改body class名稱 -->
<body class="back_news back_reset">
    <!-- 共用header -->
    <!-- @@include('layout/header-final.html') -->
    <!-- 共用header end -->
    <!-- 大標使用這個-->
    <!-- @@include('layout/h2Style.html',{
        "h2Title" : "首頁"
    }) -->
    <!-- 小標使用這個 -->
    <!-- @@include('layout/title.html',{
        "h3TitleTC" : "主題園區",
        "h3TitleEN": "Theme Area"
    }) -->
    
    @@include('layout/backNav.html')

    <div id="back" class="back_content">
        <h2>最新消息管理</h2>
        <div>
            <button @click="show">新增</button>
        </div>
        <table class="box">
            <tr>
                <th>序號</th>
                <th>照片</th>
                <th>標題</th>
                <th>文章內容</th>
                <th>更新日期</th>
                <th></th>
            </tr>
            <tr>
                <td>範例</td>
                <td><img src="./images/facilities8 (18).jpg" alt=""></td>
                <td>防疫公告</td>
                <td>亞洲第一座U型滑軌懸吊式螺旋雲霄飛，瞬間最高時速122公里。</td>
                <td>2022/5/29</td>
                <td><button @click="show">編輯</button></td>
            </tr>
        </table>

        <table class="box">
            <!-- <tr>
                <th v-for="title in memTitle">{{title}}</th>
            </tr> -->
            <tr v-for="newsRow in newsRows">
                <td>{{newsRow.news_no}} </td> 
                <td>{{newsRow.news_name}}</td>
                <!-- <td><img src="'images//'{{NewRow.}}" alt=""></td> -->
                <td>{{newsRow.news_content}}</td>
                <td>{{newsRow.news_date}}</td>
                <td><button @click="show(facilityRow.fac_no)" >編輯</button></td>
            </tr>
        </table>
        <div class="back_lightbox backLightbox" v-show="isOpen">
            <div>
                <i @click="isOpen = false" id="close" class="fa-solid fa-xmark"></i>
                <table class="innerData">
                    <tr>
                        <th>消息照片</th>
                        <td><input type="file"></td>
                    </tr>
                    <tr>
                        <th>消息標題</th>
                        <td><input type="text"></td>
                    </tr>
                    <tr>
                        <th>消息內容</th>
                        <td><input type="text"></td>
                    </tr>
                    <tr>
                        <th>更新日期</th>
                        <td><input type="date"></td>
                    </tr>
                </table>
                <div>
                    <button>新增</button>
                    <button>修改確定</button>
                </div>
            </div>
        </div>
    </div>
  
    <!--  ===============map ===============  -->
    <!-- @@include('layout/map.html') -->
    <!-- footer  -->
    <!-- @@include('layout/footer.html') -->
</body>
</html>
<!-- 共用燈箱js -->
<!-- <script src="./js/back_news.js"></script> -->
<script>
    
    let newsVue = new Vue({
        el:'#back',
        data:{
            isOpen: false,
            newsTitle: ['消息編號','消息名稱','消息內容','發布日期'],
            newsRows:[],      //資料的陣列
        },
        methods: {   
            show(){
                this.isOpen = true;
            },     
        },
        mounted(){     //第一步仔入完成才開始執行                     
            let xhr = new XMLHttpRequest();    //建立ajax物件取XHR
            // xhr.onload = function(){
            //     this.memRows = JSON.parse(xhr.responseText);
            //     alert(this.memRows);
            //     console.log(this.memRows);
            // }
            xhr.onload = () => {   //等待回復訊息
                newsVue.newsRows = JSON.parse(xhr.responseText); //收到打開資料,儲存到newVue的陣列
                console.log(newsVue.newsRows);
            }
            xhr.open("get","php/back_news.php",true);   //決定請求送至PHP
            xhr.send(null);                              //完成送出
        }
    })

</script>