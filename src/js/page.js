const list = [
    {
        id: 1,
        playPic: './images/happy4.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '伊果樂園的環境實在是很令大人及小朋友喜歡，你說為什麼呢，主要是因為有動物區以及遊樂區，全台灣的遊樂園實在是很少會有這種規模。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 2,
        playPic: './images/themePark__facWest_tourist_Lg_2.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '園區暑假表演多，表演人員都很熱情，會和遊客、小朋友互動。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 3,
        playPic: './images/friend.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '伊果樂園的環境實在是很令大人及小朋友喜歡，你說為什麼呢，主要是因為有遊樂區，全台灣的遊樂園實在是很少會有這種規模。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 4,
        playPic: './images/smiley-female.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '適合親子打發時間用，親子時光無價啊，玩好玩滿玩得好開心哈哈',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 5,
        playPic: './images/happygirl.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '遊樂區有適合小朋友玩的，但是也是有許多恐怖的設施，極速飛鷹啊，大家都很愛的衝刺濺水的獨木舟！是真的很刺激。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 6,
        playPic: './images/happy2.jpeg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '疫情期間很多游樂設施都沒開，還想說周二人少，結果發現超多學生，假日肯定人更多，洗手間擦手紙也沒有，烘乾機也不能用，而且有的馬桶超髒的。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 7,
        playPic: './images/happy3.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '伊果樂園的環境實在是很令大人及小朋友喜歡，你說為什麼呢，主要是因為有動物區以及遊樂區，全台灣的遊樂園實在是很少會有這種規模。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 8,
        playPic: './images/themePark__attrIndian_3.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '伊果樂園的環境實在是很令大人及小朋友喜歡，你說為什麼呢，主要是因為有動物區以及遊樂區，全台灣的遊樂園實在是很少會有這種規模。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 9,
        playPic: './images/themePark__attrIndian_2.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '伊果樂園的環境實在是很令大人及小朋友喜歡，你說為什麼呢，主要是因為有動物區以及遊樂區，全台灣的遊樂園實在是很少會有這種規模。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 10,
        playPic: './images/happy.jpeg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '伊果樂園的環境實在是很令大人及小朋友喜歡，你說為什麼呢，主要是因為有動物區以及遊樂區，全台灣的遊樂園實在是很少會有這種規模。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 11,
        playPic: './images/friends-having-fun.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '伊果樂園的環境實在是很令大人及小朋友喜歡，你說為什麼呢，主要是因為有動物區以及遊樂區，全台灣的遊樂園實在是很少會有這種規模。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
    {
        id: 12,
        playPic: './images/smiley-female.jpg',
        playerPic: './images/mem.png',
        memName: '小鷹',
        content: '伊果樂園的環境實在是很令大人及小朋友喜歡，你說為什麼呢，主要是因為有動物區以及遊樂區，全台灣的遊樂園實在是很少會有這種規模。',
        areaPlayerpic: './images/eagle-stand-s.png',
        areaPlayer: '小鷹',
        messageContent: '這感覺很酷，我好喜歡',
        time: '2022/12/2',
    },
]

Vue.component('list-component',{
    template: `
        <div>
        <div class="card">
            <div class="card-header"></div>
            <div class="card-pic">
                <div class="pic">
                    <img :src="item.article_image">
                </div>  
            </div>
            <div class="card-body">
                
                <div class="mem">
                    <div class="mem-pic">
                        <img :src="item.article_image">
                    </div>
                    
                    <div class="mem-name">{{item.mem_name}}</div>
                </div>
                <p>{{item.article_content}}</p>
            </div>
            <div class="card-footer"></div>
        </div>
        
        <div class="message-area">
            <div class="item" v-for="comment in comments" :key="comment.comment_no">
                <div class="pic">
                    <img :src="item.areaPlayerpic" alt="">
                </div>
                <div class="message-strip">
                    <div class="message">
                        <div class="name">{{item.mem_name}}</div>
                        <div class="message-content">
                            <p>{{item.messageContent}}</p>
                            <div class="time">{{item.article_date}}</div>
                        </div>
                    </div>
                </div>
            </div>

            <d  iv class="message-bar">
                <div class="pic">
                    <img :src="item.areaPlayerpic" alt="">
                </div>
                <input type="text" placeholder="留言">
                <a href="#"><i class="fa-solid fa-paper-plane"></i></a>
            </d>
            <div class="message-footer"></div>
        </div>
        </div>
    `,
    props: {
        item: Object,
        comments: {
            type: Array,
            default: [],
        },
    }
})
new Vue({
    el: '#pages',
    data: {
        list,
        article: {"article_no":1,"mem_no":1,"article_title":"","article_date":"","article_content":"","article_image":"","mem_name":""},
        comments: [],

    },
    methods: {
        async getArticle() {
            let xhr = new XMLHttpRequest();
        xhr.open("POST", "./php/articleAndComment.php", true);
        xhr.setRequestHeader("content-type","application/x-www-form-urlencoded");

        xhr.onload = () => {
            this.article = JSON.parse(xhr.responseText)[0][0];
            this.comments = JSON.parse(xhr.responseText)[1];
       };
        // substract currrent page no
       let currentURL = window.location.href;
       currentURL.split("page-no=");

        let dataset = {};
        dataset.articleNo = currentURL.split("page-no=")[1];
        let data_info = `json=${JSON.stringify(dataset)}`;
        // 3. sent data to php
        xhr.send(data_info);
        },
        async sendComment() {
            // 這邊處理點擊後送最新的留言到php
            // 完成後重新呼叫文章留言內容
        //     xhr.onload = () => {
        //         this.getArticle();
        //    };
        },
    },
    created() {
        let uri = window.location.href.split('?');
        if (uri.length == 2) {
            let vars = uri[1].split('&');
            let getVars = {};
            let tmp = '';
            vars.forEach(function (v) {
                tmp = v.split('=');
                if (tmp.length == 2)
                    getVars[tmp[0]] = tmp[1];
            });
            console.log(getVars);
            // do 
        }
    },
    mounted(){
        this.getArticle();
    }
})
